---
import { supabaseServer } from "../../lib/supabaseServer";

export const prerender = false;

export async function get({ cookies, redirect }) {
  const supabase = supabaseServer(cookies);
  const { data: { session } } = await supabase.auth.getSession();
  if (!session) return redirect("/signin");
  return { props: { userId: session.user.id } };
}
---

<section class="p-8 text-center">
  <h1 class="text-2xl font-bold mb-4">Verificación FaceTec (Demo)</h1>
  <p>Serás redirigido al Dashboard de prueba de FaceTec.</p>

  <a href="https://browser.facetec.com/" target="_blank"
     class="px-6 py-3 rounded bg-blue-600 text-white">
    Ir a demo oficial
  </a>

  <form method="post" action="/api/facetec/verify" class="mt-6">
    <input type="hidden" name="user_id" value={Astro.props.userId} />
    <button type="submit" class="px-6 py-3 rounded bg-green-600 text-white">
      Ya completé la prueba ✅
    </button>
  </form>
</section>
